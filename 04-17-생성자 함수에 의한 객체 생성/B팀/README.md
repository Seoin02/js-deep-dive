# 17장 생성자 함수에 의한 객체 생성

## 목차

1. [Object 생성자 함수](#1-Object-생성자-함수)
2. [생성자 함수](#2-생성자-함수)

<br />

## 1. Object 생성자 함수

- new 연산자와 함께 Object 생성자 함수를 호출하면 빈 객체를 생성하고 반환합니다.

- Object 생성자 함수 이외에도 String, Number, Boolean, Function, Array, Date, RegExp, Promise 등의 빌트인 생성자 함수를 제공합니다.

- 생성자 함수란, new 연산자를 통해 객체를 생성하는 함수를 말합니다. new 연산자는 빈 객체를 생성하는 키워드라고 보시면 됩니다.

<br />

## 2. 생성자 함수

### 2-1. 객체 리터럴에 의한 객체 생성 방식의 문제점

- 함수는 동일한 수행을 반복적으로 사용하기 위해 이용합니다. 이를 이용해, 동일한 객체를 **여러 개 생성**해야할 경우가 존재합니다. 이때 이용하는 것이 바로 **생성자 함수**입니다.


### 2-2. 생성자 함수에 의한 객체 생성 방식의 장점

- 생성자 함수를 사용하여 프로퍼티 구조가 동일한 객체 여러 개를 간편하게 생성할 수 있습니다.

- 일반 함수와 동일한 벙법으로 생성자 함수를 정의하고 new 연산자와 함께 호출하며 해당 함수는 생성자 함수로 동작합니다.


### 2-3. 생성자 함수의 인스턴스 생성 과정

-  인스턴스 생성과 this 바인딩 (런타임 이전)
    - 암묵적으로 빈 객체(인스턴스)를 생성
    - 해당 빈 객체를 this 바인딩

- 인스턴스 초기화
    - 프로퍼티나 메서드를 추가하고, 생성자 함수가 인수로 전달받은 초기값을 인스턴스 프로퍼티에 할당하여 초기화하거나 고정값을 할당
    - 쉽게 말해, 개발자가 생성자 함수 내부에서 this.프로퍼티 (or 메서드)로 초기화

- 인스턴스 반환
    - this를 암묵적으로 반환
    - this가 아닌 객체를 명시적으로 반환 ⇒ this 반환 X, 명시된 객체 반환
    - 원시값 반환 ⇒ 원시값 무시, this 반환


- 생성자 함수 내부에서 this가 아닌 값을 반환 하는 것은 생성자 함수의 기본 동작을 훼손하므로, **반드시 return을 생략합니다.**


### 2-4. 내부 메서드 [[Call]]과 [[Construct]]

- 함수는 객체입니다. 따라서 객체가 가지고 있는 **내부 슬롯과 내부 메서드**를 모두 가지고 있습니다.
- 즉, **Object라는 원형(프로토타입)을 상속**하는 방식으로 구현되어 있습니다. 따라서, Object가 가지고 있는 모든 프로퍼티를 상속받습니다.

- 또한, 함수는 객체와의 차별점을 갖고 있습니다. 이는 다른 기능을 담담하는 내부 슬롯과 내부 메서드를 가지고 있다는 의미입니다.
- 실제로 모든 함수는 **Function 프로토타입을 상속**하는 방식으로 구현되어 있습니다. 또한, Function은 Object를 상속받아 확장한 독특한 인스턴스(객체)입니다. 이때, 확장한 내부 슬롯과 내부 메서드는 [[Call]]과 [[Construct]]를 보유하므로서, 그 차이점을 드러냅니다.
  - 일반 함수로서 호출 : [[Call]] 호출 
  - new 연산자와 함께 생성자 함수로서 호출 : [[Construct]] 호출


### 2-5. constructor와 non-constructor의 구분

- 분류
  - 내부 매서드 [[Call]]을 갖는 함수 객체 ⇒ callable: 모든 함수
  - 내부 메서드 [[Construct]]를 갖는 함수 객체 ⇒ constructor: 함수 선언문, 함수 표현식, 클래스
  - 내부 메서드 [[Construct]]를 갖지 않는 함수 객체 ⇒ non-constructor: 화살표 함수


### 2-6. new 연산자

- 일반 함수와 생성자 함수에 특별한 형식적 차이는 없습니다. 다만, new 연산자를 통해, 어떤 내부 메서드가 호출될 지를 결정합니다.
  - new 연산자와 함께 함수를 호출 : 생성자 함수로 동작, [[Construct]] 호출, 화살표 함수는 불가능
  - new 연산자 없이 생성자 함수 호출 : 일반 함수로 호출, [[Call]] 호출

- 생성자 함수는 일반적으로 첫 문자를 대문자로 기술하는 **파스칼 케이스**로 명명하여 일반 함수와 구별합니다.

<br>

### 2-7. new.target

- new 연산자와 함께 생성자 함수로서 호출 : 함수 내부의 new.target === 함수 자신<br>
- new 연산자 없이 일반 함수로서 호출 : 함수 내부의 new.target === undefined

- 생성자 함수로 정의하더라도, 함수를 호출하는 모듈이 달라지거나, 다른 개발자가 new 연산자 없이 호출할 경우, 예상과 다른 코드로 동작할 수 있습니다. 이때 이용하는 것이 **new.target입니다.** 함수 내부에서 new.target 사용하여 생성자 함수로 호출했는지(new 연산자를 붙였는지) 확인하고 아닐 경우 new 연산자와 함께 재귀 호출을 통해 생성자 함수로서 호출할 수 있습니다.
